version: '2'
services:
  consul: 
    hostname: es-consul
    container_name: es-consul
    image: qnib/alpn-consul
    ports:
     - 8500
    environment:
    - DC_NAME=dc1
    - CONSUL_BOOTSTRAP_EXPECT=1
    dns: 127.0.0.1
    hostname: consul
    privileged: true


  esm:
    extends:
      file: base.yml
      service: elasticsearch
    hostname: esm
    container_name: esm
    ports:
     - 9200
    environment:
     - ES_DATA_NODE=false
     - CONSUL_CLUSTER_IPS=consul

  esd:
    extends:
      file: base.yml
      service: elasticsearch
    environment:
     - ES_MASTER_NODE=false
     - CONSUL_CLUSTER_IPS=consul
